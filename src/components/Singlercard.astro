---
const { id } = Astro.props;
console.log(id);
---

<body>
  <div class="albumcovers">
    <div class="felx-col">
      <a href="" class="single-link">
        <div class="img">
          <img src="" alt="" />
          <h2 class="h2"></h2>
          <p class="aarstal"></p>
        </div>
      </a>
    </div>
  </div>

  <style>
    .albumcovers {
      display: grid;
      grid-template-columns: 1fr 1fr 1fr;
      gap: 20px;
      padding: 30px;
    
    }



  </style>

  <script>
    // En funktion der henter og viser data
    async function fetchAndDisplaySingles() {
      try {
        // Hent data fra API'et
        const response = await fetch("https://gmrqdsphowntllgdewkq.supabase.co/rest/v1/yepha_singles", {
          method: "GET",
          headers: {
            apikey: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImdtcnFkc3Bob3dudGxsZ2Rld2txIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzM3Mzc0NTksImV4cCI6MjA0OTMxMzQ1OX0.HHGha3yx6RNf9AkkQsBICs0b4qpwkOQ2cSO0BOAGxQ8",
          },
        });

        // Konverter responsen til JSON
        const singler = await response.json();
        console.log(singler);

        // Find containeren, hvor album covers skal vises
        const productContainer = document.querySelector(".albumcovers");

        // Byg HTML dynamisk for hver single
        singler.forEach((single) => {
          const image_url = `/billeder/${single.image_url}.webp`;

          // HTML skabelon for et single album
          const productHTML = `
            <div class="felx-col">
              <a href="${single.link || "#"}">
                <div class="img">
                  <img src="${image_url}" alt="${single.image_url || "Album cover"}" />
                  <h2 class="h2">${single.overskrift || "Titel mangler"}</h2>
                  <p class="aarstal">${single.underoverskrift || "År ukendt"}</p>
                </div>
              </a>
            </div>
          `;

          // Tilføj den genererede HTML til containeren
          productContainer.insertAdjacentHTML("beforeend", productHTML);
        });
      } catch (error) {
        console.error("Fejl ved hentning af data:", error);
      }
    }

    // Kald funktionen
    fetchAndDisplaySingles();
  </script>
</body>
